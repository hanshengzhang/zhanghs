---
layout: post
category: tech
title: 从什么是一个领域聊起
---

我有这样的感觉，自己不经意间说的某些话，经常会被后来的经历或者感受反反复复的证实。大概在工作一年多的时候，大老板喊了几个人做日常的沟通，期间他问了一个问题，让我们每个人回答一下。这个问题是，什么是一个领域。我从来没有想过这个问题。当时我给的回答是，领域是一组类似需求的抽象。然后我又补了一句，不管这种需求是技术上的，还是非技术上的。


今天我仍然这样看，理解需求和问题，并能够把它们联系在一起去思考，是深入一个领域的关键。


我现在回想起2015年刚我开始工作的时候，唯一能记起来的技术上的钻研就是看各种Scala编译出来的字节码。好在过了几个月之后，我就被分配去维护我们的Druid集群。我们的Druid集群在当时算是比较大的，所以后来2016年初我去参加了Druid在中国的第一次Meetup，并且分享了一下我们的使用情况。从那次分享到今天我来快手总部参加Druid的第六次Meetup，已经过去3年了。


接触和维护Druid差不多是我工作中第一个比较复杂的任务。我们怎么去使用Druid呢？可以用一句话总结，“誓把源码读到底，哪里不对改哪里”。需求在一个系统的设计中起到非常重要的作用。我当时并没有很深刻的认识到这一点，所以发生了两类不太正确的事。第一就是以各种奇怪的方式去使用Druid，比如说奇怪的表结构，比如说自己写一些MapColumn，这些和设计需求不一致的使用方式，无一例外都失败了。而且现在看来，即便成功了，随着Druid本身的演化，也会有潜在的风险。第二类是没能意识到自己的需求可能已经Druid在设计时考虑到了。比如说我们自己周期性的调用API去清理Data，而不是去配Druid的Rule。


Druid是我接触OLAP的起点，后来我又使用或了解过很多系统，Presto, Impala, Palo, Vertica, ClickHouse, AtScale, Snowflake, … . 越来越多的系统进入视野。解决一个问题，该用什么系统呢？一个一个试试看？当然不是。关键是理解这些系统为什么会出现，它们都各自解决了什么问题，服务于什么样的需求。这样就可以避免一个一个去测试。很多人没有理解需求的情况下，就从一些的不合理的维度去比较这些系统。结果就是，往往能看到一些比较奇怪的技术文章，文章的标题虽然看似高大上，但实际上和“养鸡和养鱼哪一个更需要水”，“熊与老鹰华山论剑”之类无异。然后还被到处转载。这里我并不是吐槽。


怎么去看待技术实现？去年我在维基百科上搜索了一下领域的定义，那个定义大概说领域是共同的需求和一组解决问题的方法，前半部分居然跟我无意中说的一样。我认为大多数时候，解决问题的方法，还是由需求决定的。对应到我们日常面对的很多系统，需求决定了系统的设计和技术实现，技术实现又定义了系统的能力边界。比如说系统设计时因为需求和使用场景的原因，使用了BitMap作索引，而使用BitMap，又必将损失某些查询灵活性。


最后我想把整个太阳系比作一个领域，以此来说明我认为的理解领域的三个阶段。第一个阶段是你看到了地球，偶尔能看到月亮，觉得地球很大很好；第二个阶段是你看了几个其他的行星，分析出它们之间的相似点，并且能利用部分规律去进一步理解他们。最后一个阶段是你看到了太阳，知道了要认识这些行星，你总是要先去理解他们和太阳的关系，同时再有新的行星出现时，你不必登上去，就能知道很多关于它的信息。那么在OLAP这一块我是处于哪个阶段呢？我不知道。我是个仰望星空、脚踏实地的少年。

